<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Processing… — Junk Mailer</title>
  <meta name="robots" content="noindex,follow" />
  <script src="https://quge5.com/88/tag.min.js" data-zone="209635" async data-cfasync="false"></script>

  <!-- ========= HEAVY ADS GO HERE (MultiTag, etc.) =========
       Paste your MultiTag / heavy ad scripts inside <head>.
       Keep this page as the "money room".
  -->

  <style>
    :root{
      --bg:#050708;
      --green:#39ff88;
      --green2:#19ff6a;
      --text:#d7ffe6;
      --muted:#8cffbf;
      --line:rgba(60,255,150,.22);
      --shadow:rgba(0,0,0,.65);
    }
    *{box-sizing:border-box}
    html,body{height:100%}
    body{
      margin:0;
      font-family: ui-sans-serif, system-ui, -apple-system, Segoe UI, Roboto, Arial;
      background:
        radial-gradient(900px 600px at 30% 10%, rgba(57,255,136,.18), transparent 55%),
        radial-gradient(900px 600px at 80% 70%, rgba(57,255,136,.10), transparent 60%),
        linear-gradient(180deg, #030405, #050708);
      color: var(--text);
      overflow:hidden;
    }
    body:before{
      content:"";
      position:fixed; inset:0;
      pointer-events:none;
      background: repeating-linear-gradient(
        to bottom,
        rgba(0,0,0,0),
        rgba(0,0,0,0) 2px,
        rgba(0,0,0,.14) 3px
      );
      opacity:.55;
      mix-blend-mode:multiply;
    }

    .wrap{
      height:100%;
      display:grid;
      place-items:center;
      padding: 22px 16px;
    }
    .panel{
      width:min(820px, 100%);
      border:1px solid var(--line);
      border-radius:18px;
      padding:18px;
      background: rgba(0,0,0,.35);
      box-shadow: 0 18px 55px var(--shadow), 0 0 30px rgba(57,255,136,.10);
    }
    .title{
      margin:0 0 6px;
      font-size: 26px;
      text-shadow: 0 0 18px rgba(57,255,136,.22);
    }
    .sub{
      margin:0 0 14px;
      font-size: 13px;
      color: rgba(215,255,230,.80);
      line-height:1.5;
      max-width: 72ch;
    }

    .bar{
      height: 14px;
      border-radius: 999px;
      border:1px solid rgba(57,255,136,.28);
      background: rgba(57,255,136,.06);
      overflow:hidden;
      box-shadow: 0 0 18px rgba(57,255,136,.10) inset;
    }
    .fill{
      height:100%;
      width:0%;
      background: linear-gradient(90deg, rgba(57,255,136,.95), rgba(25,255,106,.55));
      box-shadow: 0 0 18px rgba(57,255,136,.22);
      transition: width .12s linear;
    }

    .row{
      display:flex;
      justify-content:space-between;
      gap:10px;
      margin-top:10px;
      font-size: 12px;
      color: rgba(140,255,191,.9);
      flex-wrap:wrap;
      align-items:center;
    }
    .chip{
      border:1px solid rgba(57,255,136,.22);
      background: rgba(57,255,136,.06);
      padding:6px 10px;
      border-radius:999px;
      white-space:nowrap;
    }

    .steps{
      margin-top: 12px;
      display:grid;
      gap:8px;
    }
    .step{
      padding: 10px 10px;
      border-radius: 12px;
      border:1px solid rgba(57,255,136,.12);
      background: rgba(0,0,0,.14);
      display:flex;
      justify-content:space-between;
      gap:10px;
      flex-wrap:wrap;
      font-size:12px;
      color: rgba(215,255,230,.78);
    }
    .step b{color: rgba(140,255,191,.95)}
    .ok{color: rgba(57,255,136,.95); font-weight:900}

    .cta{
      margin-top: 14px;
      display:flex;
      justify-content:flex-end;
      gap:10px;
      flex-wrap:wrap;
    }
    .btn{
      appearance:none;
      border:none;
      cursor:pointer;
      padding: 12px 14px;
      border-radius: 14px;
      font-weight: 900;
      letter-spacing:.2px;
      background: linear-gradient(180deg, var(--green), var(--green2));
      color:#031006;
      box-shadow:
        0 14px 28px rgba(25,255,106,.16),
        0 0 0 1px rgba(0,0,0,.25) inset,
        0 0 18px rgba(57,255,136,.16);
      display:none; /* shown at end */
    }
    .btn:active{transform: translateY(1px) scale(.99)}
  </style>
</head>

<body>
  <div class="wrap">
    <div class="panel">
      <h1 class="title">Processing…</h1>
      <p class="sub">
        Quick note: Junk Mailer is <b>free</b> because it’s ad-supported.
        This page runs heavier ads to fund the service — then you’ll be returned to your “Sent” screen.
      </p>

      <div class="bar" aria-label="Loading bar">
        <div class="fill" id="fill"></div>
      </div>

      <div class="row">
        <div class="chip" id="boostChip">Unlocking boost…</div>
        <div class="chip" id="etaChip">ETA: 10s</div>
        <div class="chip">Catalog: <b>53,000+</b></div>
      </div>

      <div class="steps">
        <div class="step"><span><b>Step 1</b> — Preparing request</span><span class="ok" id="s1">…</span></div>
        <div class="step"><span><b>Step 2</b> — Applying boost</span><span class="ok" id="s2">…</span></div>
        <div class="step"><span><b>Step 3</b> — Finalizing</span><span class="ok" id="s3">…</span></div>
      </div>

      <div class="cta">
        <button class="btn" id="continueBtn" type="button">Tap to continue</button>
      </div>
    </div>
  </div>

  <script>
    // ===== Loop timing (longer for MultiTag to load) =====
    const DURATION_MS = 10500; // 10.5 seconds
    const STEPS = 84;

    // ===== Reward ladder counter (advances after loop completes) =====
    const KEY = "jm_loop_count";
    function getCount() {
      const v = parseInt(localStorage.getItem(KEY) || "0", 10);
      return Number.isFinite(v) ? v : 0;
    }
    function setCount(v) {
      localStorage.setItem(KEY, String(v));
    }
    function bonusFor(count) {
      if (count <= 0) return 10;
      if (count === 1) return 3;
      return 1;
    }

    const current = getCount();
    const bonus = bonusFor(current);
    document.getElementById("boostChip").textContent = `Unlocking +${bonus}…`;

    const fill = document.getElementById("fill");
    const etaChip = document.getElementById("etaChip");
    const continueBtn = document.getElementById("continueBtn");

    // progress “steps”
    const s1 = document.getElementById("s1");
    const s2 = document.getElementById("s2");
    const s3 = document.getElementById("s3");

    let step = 0;
    const start = Date.now();

    const interval = setInterval(() => {
      step++;
      const pct = Math.min(100, (step / STEPS) * 100);
      fill.style.width = pct + "%";

      const elapsed = Date.now() - start;
      const remaining = Math.max(0, DURATION_MS - elapsed);
      etaChip.textContent = `ETA: ${Math.ceil(remaining / 1000)}s`;

      // update status steps
      if (pct >= 20) s1.textContent = "OK";
      if (pct >= 55) s2.textContent = "OK";
      if (pct >= 85) s3.textContent = "OK";

      if (step >= STEPS) {
        clearInterval(interval);

        // increment loop count AFTER this page completes
        setCount(current + 1);

        // show button instead of forcing redirect (transparent + user action)
        continueBtn.style.display = "inline-flex";
        etaChip.textContent = "Ready";

        // If user taps, go back
        continueBtn.addEventListener("click", () => {
          window.location.href = "sent.html";
        }, { once: true });

        // fallback auto-return after a short pause
        setTimeout(() => {
          if (document.visibilityState === "visible") {
            window.location.href = "sent.html";
          }
        }, 2500);
      }
    }, Math.floor(DURATION_MS / STEPS));
  </script>
